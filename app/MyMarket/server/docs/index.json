{"repository_name":"github.com/dedeme/dmWeb","body":"","program":{"html_id":"github.com/dedeme/dmWeb/toplevel","path":"toplevel.html","kind":"module","full_name":"Top Level Namespace","name":"Top Level Namespace","abstract":false,"superclass":null,"ancestors":[{"html_id":"github.com/dedeme/dmWeb/MarketLib","kind":"module","full_name":"MarketLib","name":"MarketLib"},{"html_id":"github.com/dedeme/dmWeb/DedemeLib","kind":"module","full_name":"DedemeLib","name":"DedemeLib"}],"locations":[],"repository_name":"github.com/dedeme/dmWeb","program":true,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[{"html_id":"github.com/dedeme/dmWeb/DedemeLib","kind":"module","full_name":"DedemeLib","name":"DedemeLib"},{"html_id":"github.com/dedeme/dmWeb/MarketLib","kind":"module","full_name":"MarketLib","name":"MarketLib"}],"extended_modules":[{"html_id":"github.com/dedeme/dmWeb/DedemeLib","kind":"module","full_name":"DedemeLib","name":"DedemeLib"},{"html_id":"github.com/dedeme/dmWeb/MarketLib","kind":"module","full_name":"MarketLib","name":"MarketLib"}],"subclasses":[],"including_types":[],"namespace":null,"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[],"macros":[],"types":[{"html_id":"github.com/dedeme/dmWeb/MyMarket","path":"MyMarket.html","kind":"module","full_name":"MyMarket","name":"MyMarket","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"my_market/cgi.cr","line_number":10,"url":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/cgi.cr"},{"filename":"my_market/cts.cr","line_number":5,"url":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/cts.cr"},{"filename":"my_market/my_market.cr","line_number":6,"url":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/my_market.cr"},{"filename":"my_market/version.cr","line_number":4,"url":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/version.cr"},{"filename":"my_market/data/ann.cr","line_number":6,"url":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr"},{"filename":"my_market/data/conf.cr","line_number":4,"url":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/conf.cr"},{"filename":"my_market/data/inventory.cr","line_number":6,"url":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/inventory.cr"},{"filename":"my_market/data/iout.cr","line_number":4,"url":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/iout.cr"},{"filename":"my_market/data/ledger.cr","line_number":6,"url":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ledger.cr"},{"filename":"my_market/data/journal.cr","line_number":12,"url":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/journal.cr"},{"filename":"my_market/data/users.cr","line_number":4,"url":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/users.cr"},{"filename":"my_market/data/years.cr","line_number":4,"url":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/years.cr"},{"filename":"my_market/pages/main.cr","line_number":4,"url":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/pages/main.cr"},{"filename":"my_market/pages/core/backups.cr","line_number":4,"url":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/pages/core/backups.cr"},{"filename":"my_market/pages/core/settings.cr","line_number":4,"url":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/pages/core/settings.cr"},{"filename":"my_market.cr","line_number":11,"url":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market.cr"}],"repository_name":"github.com/dedeme/dmWeb","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[{"id":"VERSION","name":"VERSION","value":"\"2018.10.9\"","doc":null,"summary":null}],"included_modules":[],"extended_modules":[{"html_id":"github.com/dedeme/dmWeb/MyMarket","kind":"module","full_name":"MyMarket","name":"MyMarket"}],"subclasses":[],"including_types":[],"namespace":null,"doc":"Dummy client-server application","summary":"<p>Dummy client-server application</p>","class_methods":[{"id":"process(rq:JSON::Any):Tuple(Bool,String)-class-method","html_id":"process(rq:JSON::Any):Tuple(Bool,String)-class-method","name":"process","doc":null,"summary":null,"abstract":false,"args":[{"name":"rq","doc":null,"default_value":"","external_name":"rq","restriction":"JSON::Any"}],"args_string":"(rq : JSON::Any) : Tuple(Bool, String)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/my_market.cr#L7","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/my_market.cr#L7","def":{"name":"process","args":[{"name":"rq","doc":null,"default_value":"","external_name":"rq","restriction":"JSON::Any"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Tuple(Bool, String)","visibility":"Public","body":"if pg = rq[\"page\"]\n  case pg.as_s\n  when \"main\"\n    Main.process(rq)\n  when \"settings\"\n    Settings.process(rq)\n  when \"backups\"\n    Backups.process(rq)\n  else\n    Cgi.fail(\"Page '#{pg.as_s}' is unknown\")\n  end\nelse\n  Cgi.fail(\"Field 'page' is missing\")\nend"}}],"constructors":[],"instance_methods":[],"macros":[],"types":[{"html_id":"github.com/dedeme/dmWeb/MyMarket/Ann","path":"MyMarket/Ann.html","kind":"class","full_name":"MyMarket::Ann","name":"Ann","abstract":false,"superclass":{"html_id":"github.com/dedeme/dmWeb/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"github.com/dedeme/dmWeb/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"github.com/dedeme/dmWeb/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"my_market/data/ann.cr","line_number":8,"url":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr"}],"repository_name":"github.com/dedeme/dmWeb","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/dedeme/dmWeb/MyMarket","kind":"module","full_name":"MyMarket","name":"MyMarket"},"doc":"Annotation","summary":"<p>Annotation</p>","class_methods":[],"constructors":[{"id":"from_json(js:JSON::Any):Ann-class-method","html_id":"from_json(js:JSON::Any):Ann-class-method","name":"from_json","doc":null,"summary":null,"abstract":false,"args":[{"name":"js","doc":null,"default_value":"","external_name":"js","restriction":"JSON::Any"}],"args_string":"(js : JSON::Any) : Ann","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L48","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L48","def":{"name":"from_json","args":[{"name":"js","doc":null,"default_value":"","external_name":"js","restriction":"JSON::Any"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Ann","visibility":"Public","body":"Ann.new(js[0].as_s, Type.parse(js[1].as_s), js[2].as_s, js[3].as_i, js[4].as_f, js[5].as_s)"}},{"id":"from_s(s:String):Ann-class-method","html_id":"from_s(s:String):Ann-class-method","name":"from_s","doc":null,"summary":null,"abstract":false,"args":[{"name":"s","doc":null,"default_value":"","external_name":"s","restriction":"String"}],"args_string":"(s : String) : Ann","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L63","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L63","def":{"name":"from_s","args":[{"name":"s","doc":null,"default_value":"","external_name":"s","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Ann","visibility":"Public","body":"Ann.from_json(JSON.parse(s))"}},{"id":"new(date,type,nick,stocks,money,description)-class-method","html_id":"new(date,type,nick,stocks,money,description)-class-method","name":"new","doc":null,"summary":null,"abstract":false,"args":[{"name":"date","doc":null,"default_value":"","external_name":"date","restriction":""},{"name":"type","doc":null,"default_value":"","external_name":"type","restriction":""},{"name":"nick","doc":null,"default_value":"","external_name":"nick","restriction":""},{"name":"stocks","doc":null,"default_value":"","external_name":"stocks","restriction":""},{"name":"money","doc":null,"default_value":"","external_name":"money","restriction":""},{"name":"description","doc":null,"default_value":"","external_name":"description","restriction":""}],"args_string":"(date, type, nick, stocks, money, description)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L30","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L30","def":{"name":"new","args":[{"name":"date","doc":null,"default_value":"","external_name":"date","restriction":""},{"name":"type","doc":null,"default_value":"","external_name":"type","restriction":""},{"name":"nick","doc":null,"default_value":"","external_name":"nick","restriction":""},{"name":"stocks","doc":null,"default_value":"","external_name":"stocks","restriction":""},{"name":"money","doc":null,"default_value":"","external_name":"money","restriction":""},{"name":"description","doc":null,"default_value":"","external_name":"description","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize(date, type, nick, stocks, money, description)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"id":"date:String-instance-method","html_id":"date:String-instance-method","name":"date","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : String","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L23","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L23","def":{"name":"date","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"String","visibility":"Public","body":"@date"}},{"id":"description:String-instance-method","html_id":"description:String-instance-method","name":"description","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : String","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L28","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L28","def":{"name":"description","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"String","visibility":"Public","body":"@description"}},{"id":"money:Float64-instance-method","html_id":"money:Float64-instance-method","name":"money","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Float64","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L27","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L27","def":{"name":"money","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Float64","visibility":"Public","body":"@money"}},{"id":"nick:String-instance-method","html_id":"nick:String-instance-method","name":"nick","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : String","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L25","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L25","def":{"name":"nick","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"String","visibility":"Public","body":"@nick"}},{"id":"stocks:Int32-instance-method","html_id":"stocks:Int32-instance-method","name":"stocks","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Int32","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L26","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L26","def":{"name":"stocks","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Int32","visibility":"Public","body":"@stocks"}},{"id":"to_json(jsb:JSON::Builder)-instance-method","html_id":"to_json(jsb:JSON::Builder)-instance-method","name":"to_json","doc":null,"summary":null,"abstract":false,"args":[{"name":"jsb","doc":null,"default_value":"","external_name":"jsb","restriction":"JSON::Builder"}],"args_string":"(jsb : JSON::Builder)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L37","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L37","def":{"name":"to_json","args":[{"name":"jsb","doc":null,"default_value":"","external_name":"jsb","restriction":"JSON::Builder"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"jsb.array do\n  jsb.string(@date)\n  jsb.string(@type.to_s)\n  jsb.string(@nick)\n  jsb.number(@stocks)\n  jsb.number(@money)\n  jsb.string(@description)\nend"}},{"id":"to_s:String-instance-method","html_id":"to_s:String-instance-method","name":"to_s","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : String","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L59","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L59","def":{"name":"to_s","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"String","visibility":"Public","body":"JSON.build do |jsb|\n  to_json(jsb)\nend"}},{"id":"type:Type-instance-method","html_id":"type:Type-instance-method","name":"type","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Type","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L24","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L24","def":{"name":"type","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Type","visibility":"Public","body":"@type"}},{"id":"year:String-instance-method","html_id":"year:String-instance-method","name":"year","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : String","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L33","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L33","def":{"name":"year","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"String","visibility":"Public","body":"@date[0..3]"}}],"macros":[],"types":[{"html_id":"github.com/dedeme/dmWeb/MyMarket/Ann/Type","path":"MyMarket/Ann/Type.html","kind":"enum","full_name":"MyMarket::Ann::Type","name":"Type","abstract":false,"superclass":null,"ancestors":[{"html_id":"github.com/dedeme/dmWeb/Enum","kind":"struct","full_name":"Enum","name":"Enum"},{"html_id":"github.com/dedeme/dmWeb/Comparable","kind":"module","full_name":"Comparable","name":"Comparable"},{"html_id":"github.com/dedeme/dmWeb/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"github.com/dedeme/dmWeb/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"my_market/data/ann.cr","line_number":9,"url":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr"}],"repository_name":"github.com/dedeme/dmWeb","program":false,"enum":true,"alias":false,"aliased":"","const":false,"constants":[{"id":"Sell","name":"Sell","value":"0","doc":null,"summary":null},{"id":"Buy","name":"Buy","value":"1","doc":null,"summary":null},{"id":"Withdrawal","name":"Withdrawal","value":"2","doc":null,"summary":null},{"id":"Income","name":"Income","value":"3","doc":null,"summary":null},{"id":"Profits","name":"Profits","value":"4","doc":null,"summary":null},{"id":"Fees","name":"Fees","value":"5","doc":"Dividends and similar","summary":"<p>Dividends and similar</p>"},{"id":"Pdif","name":"Pdif","value":"6","doc":"Direct broker fees, out of operations","summary":"<p>Direct broker fees, out of operations</p>"},{"id":"Ndif","name":"Ndif","value":"7","doc":"Correction positive (+ cash)","summary":"<p>Correction positive (+ cash)</p>"},{"id":"InitialCapital","name":"InitialCapital","value":"8","doc":"Correction negative (- cash)","summary":"<p>Correction negative (- cash)</p>"},{"id":"InitialCash","name":"InitialCash","value":"9","doc":null,"summary":null},{"id":"InitialStock","name":"InitialStock","value":"10","doc":null,"summary":null}],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/dedeme/dmWeb/MyMarket/Ann","kind":"class","full_name":"MyMarket::Ann","name":"Ann"},"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[{"id":"buy?-instance-method","html_id":"buy?-instance-method","name":"buy?","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L11","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L11","def":{"name":"buy?","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"self == Buy"}},{"id":"fees?-instance-method","html_id":"fees?-instance-method","name":"fees?","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L15","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L15","def":{"name":"fees?","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"self == Fees"}},{"id":"income?-instance-method","html_id":"income?-instance-method","name":"income?","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L13","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L13","def":{"name":"income?","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"self == Income"}},{"id":"initial_capital?-instance-method","html_id":"initial_capital?-instance-method","name":"initial_capital?","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L18","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L18","def":{"name":"initial_capital?","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"self == InitialCapital"}},{"id":"initial_cash?-instance-method","html_id":"initial_cash?-instance-method","name":"initial_cash?","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L19","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L19","def":{"name":"initial_cash?","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"self == InitialCash"}},{"id":"initial_stock?-instance-method","html_id":"initial_stock?-instance-method","name":"initial_stock?","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L20","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L20","def":{"name":"initial_stock?","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"self == InitialStock"}},{"id":"ndif?-instance-method","html_id":"ndif?-instance-method","name":"ndif?","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L17","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L17","def":{"name":"ndif?","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"self == Ndif"}},{"id":"pdif?-instance-method","html_id":"pdif?-instance-method","name":"pdif?","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L16","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L16","def":{"name":"pdif?","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"self == Pdif"}},{"id":"profits?-instance-method","html_id":"profits?-instance-method","name":"profits?","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L14","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L14","def":{"name":"profits?","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"self == Profits"}},{"id":"sell?-instance-method","html_id":"sell?-instance-method","name":"sell?","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L10","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L10","def":{"name":"sell?","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"self == Sell"}},{"id":"withdrawal?-instance-method","html_id":"withdrawal?-instance-method","name":"withdrawal?","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L12","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ann.cr#L12","def":{"name":"withdrawal?","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"self == Withdrawal"}}],"macros":[],"types":[]}]},{"html_id":"github.com/dedeme/dmWeb/MyMarket/Backups","path":"MyMarket/Backups.html","kind":"module","full_name":"MyMarket::Backups","name":"Backups","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"my_market/pages/core/backups.cr","line_number":5,"url":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/pages/core/backups.cr"}],"repository_name":"github.com/dedeme/dmWeb","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[{"html_id":"github.com/dedeme/dmWeb/MyMarket/Backups","kind":"module","full_name":"MyMarket::Backups","name":"Backups"}],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/dedeme/dmWeb/MyMarket","kind":"module","full_name":"MyMarket","name":"MyMarket"},"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[{"id":"process(rq:JSON::Any):Tuple(Bool,String)-instance-method","html_id":"process(rq:JSON::Any):Tuple(Bool,String)-instance-method","name":"process","doc":null,"summary":null,"abstract":false,"args":[{"name":"rq","doc":null,"default_value":"","external_name":"rq","restriction":"JSON::Any"}],"args_string":"(rq : JSON::Any) : Tuple(Bool, String)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/pages/core/backups.cr#L8","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/pages/core/backups.cr#L8","def":{"name":"process","args":[{"name":"rq","doc":null,"default_value":"","external_name":"rq","restriction":"JSON::Any"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Tuple(Bool, String)","visibility":"Public","body":"if r = rq[\"rq\"]\n  case r.as_s\n  when \"lists\"\n    backups, trash = Iout.backups_trash_lists.values\n    Cgi.ok do |jsb|\n      jsb.field(\"backups\") do\n        jsb.array do\n          backups.each do |b|\n            jsb.string(b)\n          end\n        end\n      end\n      jsb.field(\"trash\") do\n        jsb.array do\n          trash.each do |b|\n            jsb.string(b)\n          end\n        end\n      end\n    end\n  when \"backup\"\n    Cgi.ok do |jsb|\n      jsb.field(\"name\") do\n        jsb.string(Iout.backup)\n      end\n    end\n  when \"restoreStart\"\n    Iout.restore_start\n    Cgi.ok\n  when \"restoreAppend\"\n    if data = rq[\"data\"]\n      Iout.restore_append((      B64.decode_bytes(data.as_s)))\n      Cgi.ok\n    else\n      Cgi.fail(\"Backups-restoreStart: Field 'data' is missing\")\n    end\n  when \"restoreEnd\"\n    Cgi.ok do |jsb|\n      jsb.field(\"fail\") do\n        jsb.string(Iout.restore_end)\n      end\n    end\n  when \"autorestore\"\n    if file = rq[\"file\"]\n      Iout.autorestore(file.as_s)\n      Cgi.ok\n    else\n      Cgi.fail(\"Backups-autorestore: Field 'file' is missing\")\n    end\n  when \"restoreTrash\"\n    if file = rq[\"file\"]\n      Iout.restoreTrash(file.as_s)\n      Cgi.ok\n    else\n      Cgi.fail(\"Backups-restoreTrash: Field 'file' is missing\")\n    end\n  when \"clearTrash\"\n    Iout.clearTrash\n    Cgi.ok\n  else\n    Cgi.fail(\"Backups-rq: value '#{r.as_s}' is unknown\")\n  end\nelse\n  Cgi.fail(\"Backups: Field 'rq' is missing\")\nend"}}],"macros":[],"types":[]},{"html_id":"github.com/dedeme/dmWeb/MyMarket/Cgi","path":"MyMarket/Cgi.html","kind":"class","full_name":"MyMarket::Cgi","name":"Cgi","abstract":false,"superclass":{"html_id":"github.com/dedeme/dmWeb/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"github.com/dedeme/dmWeb/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"github.com/dedeme/dmWeb/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"my_market/cgi.cr","line_number":11,"url":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/cgi.cr"}],"repository_name":"github.com/dedeme/dmWeb","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[{"id":"Klen","name":"Klen","value":"300","doc":null,"summary":null}],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/dedeme/dmWeb/MyMarket","kind":"module","full_name":"MyMarket","name":"MyMarket"},"doc":null,"summary":null,"class_methods":[{"id":"fail(msg:String):Tuple(Bool,String)-class-method","html_id":"fail(msg:String):Tuple(Bool,String)-class-method","name":"fail","doc":"Returns a 'fail' response.","summary":"<p>Returns a 'fail' response.</p>","abstract":false,"args":[{"name":"msg","doc":null,"default_value":"","external_name":"msg","restriction":"String"}],"args_string":"(msg : String) : Tuple(Bool, String)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/cgi.cr#L121","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/cgi.cr#L121","def":{"name":"fail","args":[{"name":"msg","doc":null,"default_value":"","external_name":"msg","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Tuple(Bool, String)","visibility":"Public","body":"{true, msg}"}},{"id":"ok(&block):Tuple(Bool,String)-class-method","html_id":"ok(&amp;block):Tuple(Bool,String)-class-method","name":"ok","doc":"Returns a 'ok' response. This response contains an object and you should\nsupply its fields.\n```\nCgi.ok do |jsb|\n  jsb.field \"name\" do jsb.string \"Louis\" end\n  jsb.field \"age\" do jsb.number 23 end\nend\n```","summary":"<p>Returns a 'ok' response.</p>","abstract":false,"args":[],"args_string":"(&block) : Tuple(Bool, String)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/cgi.cr#L133","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/cgi.cr#L133","def":{"name":"ok","args":[],"double_splat":null,"splat_index":null,"yields":1,"block_arg":null,"return_type":"Tuple(Bool, String)","visibility":"Public","body":"{false, JSON.build do |jsb|\n  jsb.object do\n    yield jsb\n  end\nend}"}},{"id":"ok:Tuple(Bool,String)-class-method","html_id":"ok:Tuple(Bool,String)-class-method","name":"ok","doc":"Returns an empty 'ok' response ({false, \"{}\"})","summary":"<p>Returns an empty 'ok' response ({false, \"{}\"})</p>","abstract":false,"args":[],"args_string":" : Tuple(Bool, String)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/cgi.cr#L138","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/cgi.cr#L138","def":{"name":"ok","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Tuple(Bool, String)","visibility":"Public","body":"{false, \"{}\"}"}}],"constructors":[{"id":"new(app_name:String,port:Int32,path:String)-class-method","html_id":"new(app_name:String,port:Int32,path:String)-class-method","name":"new","doc":"'app_name' is used as key in the first communication.\n\n'path' is the directory where pages are. e.g. \"/dm/www2/Dummy2\"","summary":"<p>'app_name' is used as key in the first communication.</p>","abstract":false,"args":[{"name":"app_name","doc":null,"default_value":"","external_name":"app_name","restriction":"String"},{"name":"port","doc":null,"default_value":"","external_name":"port","restriction":"Int32"},{"name":"path","doc":null,"default_value":"","external_name":"path","restriction":"String"}],"args_string":"(app_name : String, port : Int32, path : String)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/cgi.cr#L17","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/cgi.cr#L17","def":{"name":"new","args":[{"name":"app_name","doc":null,"default_value":"","external_name":"app_name","restriction":"String"},{"name":"port","doc":null,"default_value":"","external_name":"port","restriction":"Int32"},{"name":"path","doc":null,"default_value":"","external_name":"path","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize(app_name, port, path)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"id":"listen(action:JSON::Any->Tuple(Bool,String))-instance-method","html_id":"listen(action:JSON::Any-&gt;Tuple(Bool,String))-instance-method","name":"listen","doc":"Creates server and block the program waiting requests.\n\nNormal request are send in 'action'\n\nConnection and authentication request are processed automatically","summary":"<p>Creates server and block the program waiting requests.</p>","abstract":false,"args":[{"name":"action","doc":null,"default_value":"","external_name":"action","restriction":"(JSON::Any -> Tuple(Bool, String))"}],"args_string":"(action : JSON::Any -> Tuple(Bool, String))","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/cgi.cr#L33","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/cgi.cr#L33","def":{"name":"listen","args":[{"name":"action","doc":null,"default_value":"","external_name":"action","restriction":"(JSON::Any -> Tuple(Bool, String))"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"server = HTTP::Server.new([HTTP::ErrorHandler.new, HTTP::LogHandler.new, HTTP::StaticFileHandler.new(@path, true, false)]) do |context|\n  context.response.content_type = \"text/plain\"\n  io = context.request.body\n  if io.nil?\n    context.response.print(\"Request body is missing\")\n    next\n  end\n  rq = io.gets_to_end\n  if !(rq.starts_with?(\"#{@app_name}:\"))\n    context.response.print(\"Request does not start with application name\")\n    next\n  end\n  ix = rq.index(':')\n  if ix.nil?\n    context.response.print(\"Request does not start with application name\")\n    next\n  end\n  rq = rq[(ix + 1)...rq.size]\n  ix = rq.index(':')\n  rp = \"\"\n  key = @key\n  if ix.nil?\n    key = rq\n    if key != @session_id\n      rp = JSON.build do |jsb|\n        jsb.object do\n          jsb.field(\"key\", \"\")\n          jsb.field(\"connectionId\", \"\")\n        end\n      end\n    else\n      rp = JSON.build do |jsb|\n        jsb.object do\n          jsb.field(\"key\", @key)\n          jsb.field(\"connectionId\", @connection_id)\n        end\n      end\n    end\n  else\n    if ix == 0\n      if @first_time\n        @first_time = false\n        rp = JSON.build do |jsb|\n          jsb.object do\n            jsb.field(\"key\", @key)\n            jsb.field(\"sessionId\", @session_id)\n          end\n        end\n        key = B64.key(@app_name, Klen)\n      else\n        context.response.print(\"Connection already open\")\n        next\n      end\n    else\n      ss_id = rq[0...ix]\n      msg = B64.decryp(@key, rq[(ix + 1)...rq.size])\n      if ss_id == @session_id\n        fail, rp = action.call(JSON.parse(msg))\n        if fail\n          context.response.print(rp)\n          next\n        end\n      else\n        context.response.print(\"Bad session id\")\n        next\n      end\n    end\n  end\n  context.response.print(B64.cryp(key, rp))\nend\nserver.bind_tcp(\"localhost\", @port)\nputs(\"Listening on #{@port}\")\nserver.listen\n"}}],"macros":[],"types":[]},{"html_id":"github.com/dedeme/dmWeb/MyMarket/Conf","path":"MyMarket/Conf.html","kind":"class","full_name":"MyMarket::Conf","name":"Conf","abstract":false,"superclass":{"html_id":"github.com/dedeme/dmWeb/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"github.com/dedeme/dmWeb/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"github.com/dedeme/dmWeb/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"my_market/data/conf.cr","line_number":6,"url":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/conf.cr"}],"repository_name":"github.com/dedeme/dmWeb","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/dedeme/dmWeb/MyMarket","kind":"module","full_name":"MyMarket","name":"MyMarket"},"doc":"Data of configuration","summary":"<p>Data of configuration</p>","class_methods":[],"constructors":[{"id":"from_s(js:String):Conf-class-method","html_id":"from_s(js:String):Conf-class-method","name":"from_s","doc":null,"summary":null,"abstract":false,"args":[{"name":"js","doc":null,"default_value":"","external_name":"js","restriction":"String"}],"args_string":"(js : String) : Conf","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/conf.cr#L23","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/conf.cr#L23","def":{"name":"from_s","args":[{"name":"js","doc":null,"default_value":"","external_name":"js","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Conf","visibility":"Public","body":"js = JSON.parse(js)\nConf.new(js[\"lang\"].as_s, js[\"user\"].as_s, js[\"year\"].as_s)\n"}},{"id":"new(lang:String,user:String,year:String)-class-method","html_id":"new(lang:String,user:String,year:String)-class-method","name":"new","doc":null,"summary":null,"abstract":false,"args":[{"name":"lang","doc":null,"default_value":"","external_name":"lang","restriction":"String"},{"name":"user","doc":null,"default_value":"","external_name":"user","restriction":"String"},{"name":"year","doc":null,"default_value":"","external_name":"year","restriction":"String"}],"args_string":"(lang : String, user : String, year : String)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/conf.cr#L10","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/conf.cr#L10","def":{"name":"new","args":[{"name":"lang","doc":null,"default_value":"","external_name":"lang","restriction":"String"},{"name":"user","doc":null,"default_value":"","external_name":"user","restriction":"String"},{"name":"year","doc":null,"default_value":"","external_name":"year","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize(lang, user, year)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"id":"lang:String-instance-method","html_id":"lang:String-instance-method","name":"lang","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : String","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/conf.cr#L7","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/conf.cr#L7","def":{"name":"lang","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@lang"}},{"id":"lang=(lang)-instance-method","html_id":"lang=(lang)-instance-method","name":"lang=","doc":null,"summary":null,"abstract":false,"args":[{"name":"lang","doc":null,"default_value":"","external_name":"lang","restriction":""}],"args_string":"(lang)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/conf.cr#L7","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/conf.cr#L7","def":{"name":"lang=","args":[{"name":"lang","doc":null,"default_value":"","external_name":"lang","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@lang = lang"}},{"id":"to_s:String-instance-method","html_id":"to_s:String-instance-method","name":"to_s","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : String","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/conf.cr#L13","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/conf.cr#L13","def":{"name":"to_s","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"String","visibility":"Public","body":"JSON.build do |jsb|\n  jsb.object do\n    jsb.field(\"lang\", @lang)\n    jsb.field(\"user\", @user)\n    jsb.field(\"year\", @year)\n  end\nend"}},{"id":"user:String-instance-method","html_id":"user:String-instance-method","name":"user","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : String","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/conf.cr#L8","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/conf.cr#L8","def":{"name":"user","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@user"}},{"id":"user=(user)-instance-method","html_id":"user=(user)-instance-method","name":"user=","doc":null,"summary":null,"abstract":false,"args":[{"name":"user","doc":null,"default_value":"","external_name":"user","restriction":""}],"args_string":"(user)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/conf.cr#L8","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/conf.cr#L8","def":{"name":"user=","args":[{"name":"user","doc":null,"default_value":"","external_name":"user","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@user = user"}},{"id":"year:String-instance-method","html_id":"year:String-instance-method","name":"year","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : String","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/conf.cr#L9","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/conf.cr#L9","def":{"name":"year","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@year"}},{"id":"year=(year)-instance-method","html_id":"year=(year)-instance-method","name":"year=","doc":null,"summary":null,"abstract":false,"args":[{"name":"year","doc":null,"default_value":"","external_name":"year","restriction":""}],"args_string":"(year)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/conf.cr#L9","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/conf.cr#L9","def":{"name":"year=","args":[{"name":"year","doc":null,"default_value":"","external_name":"year","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@year = year"}}],"macros":[],"types":[]},{"html_id":"github.com/dedeme/dmWeb/MyMarket/Cts","path":"MyMarket/Cts.html","kind":"module","full_name":"MyMarket::Cts","name":"Cts","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"my_market/cts.cr","line_number":6,"url":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/cts.cr"}],"repository_name":"github.com/dedeme/dmWeb","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[{"id":"APP_NAME","name":"APP_NAME","value":"\"MyMarket\"","doc":"Its value must be the same in the client side","summary":"<p>Its value must be the same in the client side</p>"},{"id":"BROWSER_PATH","name":"BROWSER_PATH","value":"\"http://localhost:#{PORT}/index.html\"","doc":"Browser point of entry","summary":"<p>Browser point of entry</p>"},{"id":"DATA_VERSION","name":"DATA_VERSION","value":"\"MyMarket: Data version 201810\"","doc":"Data version","summary":"<p>Data version</p>"},{"id":"PORT","name":"PORT","value":"18100","doc":"PORT","summary":"<p>PORT</p>"},{"id":"QUOTES_DIR","name":"QUOTES_DIR","value":"\"/dm/wwwcgi/dmcgi/Quotes/data\"","doc":"Quotes directory","summary":"<p>Quotes directory</p>"},{"id":"WEB_DIRECTORY","name":"WEB_DIRECTORY","value":"\"/dm/www2/#{APP_NAME}\"","doc":"Absolute path of web root directory","summary":"<p>Absolute path of web root directory</p>"},{"id":"WEB_TMP","name":"WEB_TMP","value":"\"#{WEB_DIRECTORY}/tmp\"","doc":"Web temporary directory","summary":"<p>Web temporary directory</p>"}],"included_modules":[],"extended_modules":[{"html_id":"github.com/dedeme/dmWeb/MyMarket/Cts","kind":"module","full_name":"MyMarket::Cts","name":"Cts"}],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/dedeme/dmWeb/MyMarket","kind":"module","full_name":"MyMarket","name":"MyMarket"},"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[{"id":"annotations_dir-instance-method","html_id":"annotations_dir-instance-method","name":"annotations_dir","doc":"Temporary directory connected with www","summary":"<p>Temporary directory connected with www</p>","abstract":false,"args":[],"args_string":"","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/cts.cr#L56","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/cts.cr#L56","def":{"name":"annotations_dir","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"\"#{data_dir}/annotations\""}},{"id":"backups_dir-instance-method","html_id":"backups_dir-instance-method","name":"backups_dir","doc":"Automatica backups","summary":"<p>Automatica backups</p>","abstract":false,"args":[],"args_string":"","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/cts.cr#L36","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/cts.cr#L36","def":{"name":"backups_dir","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"\"#{Sys.home}/backups\""}},{"id":"data_dir-instance-method","html_id":"data_dir-instance-method","name":"data_dir","doc":"Data which will be saved in backups","summary":"<p>Data which will be saved in backups</p>","abstract":false,"args":[],"args_string":"","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/cts.cr#L31","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/cts.cr#L31","def":{"name":"data_dir","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"\"#{Sys.home}/data\""}},{"id":"quotes_dir-instance-method","html_id":"quotes_dir-instance-method","name":"quotes_dir","doc":"Temporary directory connected with www","summary":"<p>Temporary directory connected with www</p>","abstract":false,"args":[],"args_string":"","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/cts.cr#L51","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/cts.cr#L51","def":{"name":"quotes_dir","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"\"#{Sys.home}/Quotes\""}},{"id":"tmp_dir-instance-method","html_id":"tmp_dir-instance-method","name":"tmp_dir","doc":"Temporary directory connected with www","summary":"<p>Temporary directory connected with www</p>","abstract":false,"args":[],"args_string":"","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/cts.cr#L46","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/cts.cr#L46","def":{"name":"tmp_dir","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"\"#{Sys.home}/tmp\""}},{"id":"trash_dir-instance-method","html_id":"trash_dir-instance-method","name":"trash_dir","doc":"Decarded backups","summary":"<p>Decarded backups</p>","abstract":false,"args":[],"args_string":"","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/cts.cr#L41","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/cts.cr#L41","def":{"name":"trash_dir","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"\"#{Sys.home}/trash\""}}],"macros":[],"types":[]},{"html_id":"github.com/dedeme/dmWeb/MyMarket/Inventory","path":"MyMarket/Inventory.html","kind":"class","full_name":"MyMarket::Inventory","name":"Inventory","abstract":false,"superclass":{"html_id":"github.com/dedeme/dmWeb/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"github.com/dedeme/dmWeb/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"github.com/dedeme/dmWeb/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"my_market/data/inventory.cr","line_number":16,"url":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/inventory.cr"}],"repository_name":"github.com/dedeme/dmWeb","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/dedeme/dmWeb/MyMarket","kind":"module","full_name":"MyMarket","name":"MyMarket"},"doc":null,"summary":null,"class_methods":[],"constructors":[{"id":"new-class-method","html_id":"new-class-method","name":"new","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/inventory.cr#L19","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/inventory.cr#L19","def":{"name":"new","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"id":"[]?(nick:String):InventoryEntry?-instance-method","html_id":"[]?(nick:String):InventoryEntry?-instance-method","name":"[]?","doc":null,"summary":null,"abstract":false,"args":[{"name":"nick","doc":null,"default_value":"","external_name":"nick","restriction":"String"}],"args_string":"(nick : String) : InventoryEntry?","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/inventory.cr#L22","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/inventory.cr#L22","def":{"name":"[]?","args":[{"name":"nick","doc":null,"default_value":"","external_name":"nick","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"InventoryEntry | Nil","visibility":"Public","body":"@entries[nick]?"}},{"id":"accValue:Float64-instance-method","html_id":"accValue:Float64-instance-method","name":"accValue","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Float64","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/inventory.cr#L59","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/inventory.cr#L59","def":{"name":"accValue","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Float64","visibility":"Public","body":"entries.values.reduce(0) do |acc, e|\n  acc + (e.stocks * e.price)\nend"}},{"id":"add(nick:String,stocks:Int32,price:Float64)-instance-method","html_id":"add(nick:String,stocks:Int32,price:Float64)-instance-method","name":"add","doc":null,"summary":null,"abstract":false,"args":[{"name":"nick","doc":null,"default_value":"","external_name":"nick","restriction":"String"},{"name":"stocks","doc":null,"default_value":"","external_name":"stocks","restriction":"Int32"},{"name":"price","doc":null,"default_value":"","external_name":"price","restriction":"Float64"}],"args_string":"(nick : String, stocks : Int32, price : Float64)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/inventory.cr#L30","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/inventory.cr#L30","def":{"name":"add","args":[{"name":"nick","doc":null,"default_value":"","external_name":"nick","restriction":"String"},{"name":"stocks","doc":null,"default_value":"","external_name":"stocks","restriction":"Int32"},{"name":"price","doc":null,"default_value":"","external_name":"price","restriction":"Float64"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"e = entries[nick]?\nif (e)\n  nstocks = stocks + e.stocks\n  entries[nick] = InventoryEntry.new(nstocks, ((stocks * price) + (e.stocks * e.price)) / nstocks, 0.0)\nelse\n  if entries[nick] = InventoryEntry.new(stocks, price, 0.0)\n  end\nend\n"}},{"id":"entries:Hash(String,MyMarket::InventoryEntry)-instance-method","html_id":"entries:Hash(String,MyMarket::InventoryEntry)-instance-method","name":"entries","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Hash(String, MyMarket::InventoryEntry)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/inventory.cr#L17","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/inventory.cr#L17","def":{"name":"entries","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@entries"}},{"id":"marketValue:Float64-instance-method","html_id":"marketValue:Float64-instance-method","name":"marketValue","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Float64","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/inventory.cr#L63","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/inventory.cr#L63","def":{"name":"marketValue","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Float64","visibility":"Public","body":"entries.values.reduce(0) do |acc, e|\n  acc + (e.stocks * e.close)\nend"}},{"id":"nicks:Array(String)-instance-method","html_id":"nicks:Array(String)-instance-method","name":"nicks","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Array(String)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/inventory.cr#L26","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/inventory.cr#L26","def":{"name":"nicks","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Array(String)","visibility":"Public","body":"entries.keys"}},{"id":"remove(nick:String,stocks:Int32)-instance-method","html_id":"remove(nick:String,stocks:Int32)-instance-method","name":"remove","doc":null,"summary":null,"abstract":false,"args":[{"name":"nick","doc":null,"default_value":"","external_name":"nick","restriction":"String"},{"name":"stocks","doc":null,"default_value":"","external_name":"stocks","restriction":"Int32"}],"args_string":"(nick : String, stocks : Int32)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/inventory.cr#L44","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/inventory.cr#L44","def":{"name":"remove","args":[{"name":"nick","doc":null,"default_value":"","external_name":"nick","restriction":"String"},{"name":"stocks","doc":null,"default_value":"","external_name":"stocks","restriction":"Int32"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"e = entries[nick]\nnstocks = e.stocks - stocks\nif nstocks == 0\n  entries.delete(nicks)\nelse\n  if entries[nick] = InventoryEntry.new(nstocks, e.price, 0.0)\n  end\nend\n"}},{"id":"setClose(nick:String,close:Float64)-instance-method","html_id":"setClose(nick:String,close:Float64)-instance-method","name":"setClose","doc":null,"summary":null,"abstract":false,"args":[{"name":"nick","doc":null,"default_value":"","external_name":"nick","restriction":"String"},{"name":"close","doc":null,"default_value":"","external_name":"close","restriction":"Float64"}],"args_string":"(nick : String, close : Float64)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/inventory.cr#L54","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/inventory.cr#L54","def":{"name":"setClose","args":[{"name":"nick","doc":null,"default_value":"","external_name":"nick","restriction":"String"},{"name":"close","doc":null,"default_value":"","external_name":"close","restriction":"Float64"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"e = entries[nick]\nemtries[nick] = InventoryEntry.new(e.stocks, e.price, close)\n"}}],"macros":[],"types":[]},{"html_id":"github.com/dedeme/dmWeb/MyMarket/InventoryEntry","path":"MyMarket/InventoryEntry.html","kind":"class","full_name":"MyMarket::InventoryEntry","name":"InventoryEntry","abstract":false,"superclass":{"html_id":"github.com/dedeme/dmWeb/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"github.com/dedeme/dmWeb/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"github.com/dedeme/dmWeb/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"my_market/data/inventory.cr","line_number":7,"url":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/inventory.cr"}],"repository_name":"github.com/dedeme/dmWeb","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/dedeme/dmWeb/MyMarket","kind":"module","full_name":"MyMarket","name":"MyMarket"},"doc":null,"summary":null,"class_methods":[],"constructors":[{"id":"new(stocks,price,close)-class-method","html_id":"new(stocks,price,close)-class-method","name":"new","doc":null,"summary":null,"abstract":false,"args":[{"name":"stocks","doc":null,"default_value":"","external_name":"stocks","restriction":""},{"name":"price","doc":null,"default_value":"","external_name":"price","restriction":""},{"name":"close","doc":null,"default_value":"","external_name":"close","restriction":""}],"args_string":"(stocks, price, close)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/inventory.cr#L12","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/inventory.cr#L12","def":{"name":"new","args":[{"name":"stocks","doc":null,"default_value":"","external_name":"stocks","restriction":""},{"name":"price","doc":null,"default_value":"","external_name":"price","restriction":""},{"name":"close","doc":null,"default_value":"","external_name":"close","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize(stocks, price, close)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"id":"close:Float64-instance-method","html_id":"close:Float64-instance-method","name":"close","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Float64","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/inventory.cr#L10","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/inventory.cr#L10","def":{"name":"close","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Float64","visibility":"Public","body":"@close"}},{"id":"price:Float64-instance-method","html_id":"price:Float64-instance-method","name":"price","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Float64","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/inventory.cr#L9","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/inventory.cr#L9","def":{"name":"price","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Float64","visibility":"Public","body":"@price"}},{"id":"stocks:Int32-instance-method","html_id":"stocks:Int32-instance-method","name":"stocks","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Int32","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/inventory.cr#L8","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/inventory.cr#L8","def":{"name":"stocks","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Int32","visibility":"Public","body":"@stocks"}}],"macros":[],"types":[]},{"html_id":"github.com/dedeme/dmWeb/MyMarket/Iout","path":"MyMarket/Iout.html","kind":"module","full_name":"MyMarket::Iout","name":"Iout","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"my_market/data/iout.cr","line_number":5,"url":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/iout.cr"}],"repository_name":"github.com/dedeme/dmWeb","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[{"html_id":"github.com/dedeme/dmWeb/MyMarket/Iout","kind":"module","full_name":"MyMarket::Iout","name":"Iout"}],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/dedeme/dmWeb/MyMarket","kind":"module","full_name":"MyMarket","name":"MyMarket"},"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[{"id":"automatic_backup-instance-method","html_id":"automatic_backup-instance-method","name":"automatic_backup","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/iout.cr#L119","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/iout.cr#L119","def":{"name":"automatic_backup","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"t = Time.now.to_s(\"%Y%m%d\")\nExt.zip(Cts.data_dir, \"#{Cts.backups_dir}/#{t}.zip\")\nd1 = (Time.now - 7.days).to_s(\"%Y%m%d\")\nd2 = (Time.now - 1.year).to_s(\"%Y%m%d\")\nprevious = \"      \"\n(Io.children(Cts.backups_dir)).sort.reverse.each do |fname|\n  name = fname[0..-5]\n  if name < d2\n    if name[0..3] == previous[0..3]\n      Io.del(\"#{Cts.backups_dir}/#{fname}\")\n    else\n      previous = name\n    end\n  else\n    if name < d1\n      if name[0..5] == previous[0..5]\n        Io.del(\"#{Cts.backups_dir}/#{fname}\")\n      else\n        previous = name\n      end\n    end\n  end\nend\n"}},{"id":"autorestore(file:String)-instance-method","html_id":"autorestore(file:String)-instance-method","name":"autorestore","doc":null,"summary":null,"abstract":false,"args":[{"name":"file","doc":null,"default_value":"","external_name":"file","restriction":"String"}],"args_string":"(file : String)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/iout.cr#L109","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/iout.cr#L109","def":{"name":"autorestore","args":[{"name":"file","doc":null,"default_value":"","external_name":"file","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"Ext.unzip(\"#{Cts.backups_dir}/#{file}\", Cts.tmp_dir)\nt = Time.now.to_s(\"%Y%m%d-%H%M%S%L\")\nExt.zip(Cts.data_dir, \"#{Cts.trash_dir}/#{t}.zip\")\nIo.del(Cts.data_dir)\nIo.rename(\"#{Cts.tmp_dir}/data\", Cts.data_dir)\n"}},{"id":"backup:String-instance-method","html_id":"backup:String-instance-method","name":"backup","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : String","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/iout.cr#L61","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/iout.cr#L61","def":{"name":"backup","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"String","visibility":"Public","body":"name = \"#{Cts::APP_NAME}Backup#{Time.now.to_s(\"%Y%m%d\")}.zip\"\nIo.del(Cts::WEB_TMP)\nIo.mkdir(Cts::WEB_TMP)\nExt.zip(Cts.data_dir, \"#{Cts.tmp_dir}/#{name}\")\nname\n"}},{"id":"backups_trash_lists:NamedTuple()-instance-method","html_id":"backups_trash_lists:NamedTuple()-instance-method","name":"backups_trash_lists","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : NamedTuple()","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/iout.cr#L159","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/iout.cr#L159","def":{"name":"backups_trash_lists","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"NamedTuple(backups: Array(String), trash: Array(String))","visibility":"Public","body":"{backups: Io.children(Cts.backups_dir), trash: Io.children(Cts.trash_dir)}"}},{"id":"clearTrash-instance-method","html_id":"clearTrash-instance-method","name":"clearTrash","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/iout.cr#L154","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/iout.cr#L154","def":{"name":"clearTrash","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"Io.del(Cts.trash_dir)\nIo.mkdir(Cts.trash_dir)\n"}},{"id":"init-instance-method","html_id":"init-instance-method","name":"init","doc":"Initialize data base in 'home' and in 'web'","summary":"<p>Initialize data base in 'home' and in 'web'</p>","abstract":false,"args":[],"args_string":"","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/iout.cr#L9","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/iout.cr#L9","def":{"name":"init","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"if !(Io.exists?(Cts::WEB_DIRECTORY))\n  raise(IO::Error.new(\"'#{Cts::WEB_DIRECTORY}' not found\"))\nend\nIo.mkdir(Cts::WEB_TMP)\nif !(Io.exists?(Cts.data_dir))\n  Io.mkdir(Cts.data_dir)\n  Io.mkdir(Cts.backups_dir)\n  Io.mkdir(Cts.trash_dir)\n  Io.symlink(Cts::WEB_TMP, Cts.tmp_dir)\n  Io.symlink(Cts::QUOTES_DIR, Cts.quotes_dir)\n  year = Time.new.year.to_s\n  Io.mkdir(Cts.annotations_dir)\n  Io.mkdir(\"#{Cts.annotations_dir}/My\")\n  Io.write(\"#{Cts.annotations_dir}/My/#{year}\", \"[]\")\n  Io.write(\"#{Cts.data_dir}/version.txt\", Cts::DATA_VERSION)\n  write_conf(Conf.new(\"es\", \"My\", year))\nend\n"}},{"id":"read_conf:Conf-instance-method","html_id":"read_conf:Conf-instance-method","name":"read_conf","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Conf","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/iout.cr#L39","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/iout.cr#L39","def":{"name":"read_conf","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Conf","visibility":"Public","body":"Conf.from_s(read_conf_s)"}},{"id":"read_conf_s:String-instance-method","html_id":"read_conf_s:String-instance-method","name":"read_conf_s","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : String","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/iout.cr#L35","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/iout.cr#L35","def":{"name":"read_conf_s","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"String","visibility":"Public","body":"Io.read(\"#{Cts.data_dir}/conf.db\")"}},{"id":"restore_append(bs:Bytes)-instance-method","html_id":"restore_append(bs:Bytes)-instance-method","name":"restore_append","doc":null,"summary":null,"abstract":false,"args":[{"name":"bs","doc":null,"default_value":"","external_name":"bs","restriction":"Bytes"}],"args_string":"(bs : Bytes)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/iout.cr#L74","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/iout.cr#L74","def":{"name":"restore_append","args":[{"name":"bs","doc":null,"default_value":"","external_name":"bs","restriction":"Bytes"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"f = Io.aopen(\"#{Cts.tmp_dir}/backup.zip\")\nIo.write(f, bs)\nf.close\n"}},{"id":"restore_end:String-instance-method","html_id":"restore_end:String-instance-method","name":"restore_end","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : String","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/iout.cr#L80","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/iout.cr#L80","def":{"name":"restore_end","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"String","visibility":"Public","body":"fpath = \"#{Cts.tmp_dir}/backup.zip\"\nif !(Io.exists?(fpath))\n  return \"'#{fpath}' not found\"\nend\nbegin\n  Ext.unzip(fpath, Cts.tmp_dir)\nrescue ex\n  puts(ex.message)\n  return \"restore:unzip\"\nend\nfversion = \"#{Cts.tmp_dir}/data/version.txt\"\nif !(Io.exists?(fversion))\n  return \"restore:valid\"\nend\nif Cts::DATA_VERSION != (Io.read(fversion))\n  return \"restore:version\"\nend\nt = Time.now.to_s(\"%Y%m%d-%H%M%S%L\")\nExt.zip(Cts.data_dir, \"#{Cts.trash_dir}/#{t}.zip\")\nIo.del(Cts.data_dir)\nIo.rename(\"#{Cts.tmp_dir}/data\", Cts.data_dir)\n\"\"\n"}},{"id":"restore_start-instance-method","html_id":"restore_start-instance-method","name":"restore_start","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/iout.cr#L69","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/iout.cr#L69","def":{"name":"restore_start","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"Io.del(Cts::WEB_TMP)\nIo.mkdir(Cts::WEB_TMP)\n"}},{"id":"restoreTrash(file:String)-instance-method","html_id":"restoreTrash(file:String)-instance-method","name":"restoreTrash","doc":null,"summary":null,"abstract":false,"args":[{"name":"file","doc":null,"default_value":"","external_name":"file","restriction":"String"}],"args_string":"(file : String)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/iout.cr#L144","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/iout.cr#L144","def":{"name":"restoreTrash","args":[{"name":"file","doc":null,"default_value":"","external_name":"file","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"Ext.unzip(\"#{Cts.trash_dir}/#{file}\", Cts.tmp_dir)\nt = Time.now.to_s(\"%Y%m%d-%H%M%S%L\")\nExt.zip(Cts.data_dir, \"#{Cts.trash_dir}/#{t}.zip\")\nIo.del(Cts.data_dir)\nIo.rename(\"#{Cts.tmp_dir}/data\", Cts.data_dir)\n"}},{"id":"set_lang(lang:String)-instance-method","html_id":"set_lang(lang:String)-instance-method","name":"set_lang","doc":null,"summary":null,"abstract":false,"args":[{"name":"lang","doc":null,"default_value":"","external_name":"lang","restriction":"String"}],"args_string":"(lang : String)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/iout.cr#L43","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/iout.cr#L43","def":{"name":"set_lang","args":[{"name":"lang","doc":null,"default_value":"","external_name":"lang","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"cf = read_conf\ncf.lang = lang\nwrite_conf(cf)\n"}},{"id":"set_user(user:String)-instance-method","html_id":"set_user(user:String)-instance-method","name":"set_user","doc":null,"summary":null,"abstract":false,"args":[{"name":"user","doc":null,"default_value":"","external_name":"user","restriction":"String"}],"args_string":"(user : String)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/iout.cr#L49","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/iout.cr#L49","def":{"name":"set_user","args":[{"name":"user","doc":null,"default_value":"","external_name":"user","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"cf = read_conf\ncf.user = user\nwrite_conf(cf)\n"}},{"id":"set_year(year:String)-instance-method","html_id":"set_year(year:String)-instance-method","name":"set_year","doc":null,"summary":null,"abstract":false,"args":[{"name":"year","doc":null,"default_value":"","external_name":"year","restriction":"String"}],"args_string":"(year : String)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/iout.cr#L55","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/iout.cr#L55","def":{"name":"set_year","args":[{"name":"year","doc":null,"default_value":"","external_name":"year","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"cf = read_conf\ncf.year = year\nwrite_conf(cf)\n"}}],"macros":[],"types":[]},{"html_id":"github.com/dedeme/dmWeb/MyMarket/Journal","path":"MyMarket/Journal.html","kind":"class","full_name":"MyMarket::Journal","name":"Journal","abstract":false,"superclass":{"html_id":"github.com/dedeme/dmWeb/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"github.com/dedeme/dmWeb/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"github.com/dedeme/dmWeb/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"my_market/data/journal.cr","line_number":21,"url":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/journal.cr"}],"repository_name":"github.com/dedeme/dmWeb","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/dedeme/dmWeb/MyMarket","kind":"module","full_name":"MyMarket","name":"MyMarket"},"doc":null,"summary":null,"class_methods":[{"id":"close(ledger:Ledger,inventory:Inventory,after:Journal,after_year:String):NamedTuple()-class-method","html_id":"close(ledger:Ledger,inventory:Inventory,after:Journal,after_year:String):NamedTuple()-class-method","name":"close","doc":null,"summary":null,"abstract":false,"args":[{"name":"ledger","doc":null,"default_value":"","external_name":"ledger","restriction":"Ledger"},{"name":"inventory","doc":null,"default_value":"","external_name":"inventory","restriction":"Inventory"},{"name":"after","doc":null,"default_value":"","external_name":"after","restriction":"Journal"},{"name":"after_year","doc":null,"default_value":"","external_name":"after_year","restriction":"String"}],"args_string":"(ledger : Ledger, inventory : Inventory, after : Journal, after_year : String) : NamedTuple()","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/journal.cr#L218","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/journal.cr#L218","def":{"name":"close","args":[{"name":"ledger","doc":null,"default_value":"","external_name":"ledger","restriction":"Ledger"},{"name":"inventory","doc":null,"default_value":"","external_name":"inventory","restriction":"Inventory"},{"name":"after","doc":null,"default_value":"","external_name":"after","restriction":"Journal"},{"name":"after_year","doc":null,"default_value":"","external_name":"after_year","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"NamedTuple(error: String, journal: Journal)","visibility":"Public","body":"r = Journal.new\ndate = after_year + \"0101\"\ncapital = (((ledger.capital + ledger.sells) + ledger.fees) + ledger.incomes) + ledger.differences\nr.add(Ann.new(date, Ann::InitialCapital, \"\", 0, capital, \"\"))\nr.add(Ann.new(date, Ann::InitialCash, \"\", 0, ledger.cash, \"\"))\ninventory.entries.each do |nick, entry|\n  r.add(Ann.new(date, Ann::IntialStock, nick, entry.stocks, entry.price, \"\"))\nend\n(after.anns.skip do |a|\n  a.date[4..-1] == \"0101\"\nend).each do |a|\n  error = r.add(a)\n  if error != \"\"\n    break\n  end\nend\nif error == \"\"\n  {error: \"\", journal: r}\nelse\n  {error: error, journal: Journal.new}\nend\nerror\n"}}],"constructors":[{"id":"from_json(js:JSON::Any):Journal-class-method","html_id":"from_json(js:JSON::Any):Journal-class-method","name":"from_json","doc":null,"summary":null,"abstract":false,"args":[{"name":"js","doc":null,"default_value":"","external_name":"js","restriction":"JSON::Any"}],"args_string":"(js : JSON::Any) : Journal","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/journal.cr#L203","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/journal.cr#L203","def":{"name":"from_json","args":[{"name":"js","doc":null,"default_value":"","external_name":"js","restriction":"JSON::Any"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Journal","visibility":"Public","body":"r = Journal.new\njs.as_a.each do |j|\n  err = r.add(Ann.from_json(j))\n  if err != \"\"\n    raise(IllegalArgument.new(\"Bad annotation\"))\n  end\nend\nr\n"}},{"id":"from_s(s:String):Journal-class-method","html_id":"from_s(s:String):Journal-class-method","name":"from_s","doc":null,"summary":null,"abstract":false,"args":[{"name":"s","doc":null,"default_value":"","external_name":"s","restriction":"String"}],"args_string":"(s : String) : Journal","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/journal.cr#L214","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/journal.cr#L214","def":{"name":"from_s","args":[{"name":"s","doc":null,"default_value":"","external_name":"s","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Journal","visibility":"Public","body":"self.from_json(JSON.parse(s))"}},{"id":"new-class-method","html_id":"new-class-method","name":"new","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/journal.cr#L24","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/journal.cr#L24","def":{"name":"new","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"id":"add(ann:Ann):String-instance-method","html_id":"add(ann:Ann):String-instance-method","name":"add","doc":"Adds an annotation.\n\nIf operation fails returns:\n* 0date (e.g. \"020181009\") if nick is not in inventory when selling.\n* 1date (e.g. \"120181009\") if trying to sell more stocks than there\n  are in inventory.","summary":"<p>Adds an annotation.</p>","abstract":false,"args":[{"name":"ann","doc":null,"default_value":"","external_name":"ann","restriction":"Ann"}],"args_string":"(ann : Ann) : String","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/journal.cr#L33","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/journal.cr#L33","def":{"name":"add","args":[{"name":"ann","doc":null,"default_value":"","external_name":"ann","restriction":"Ann"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"String","visibility":"Public","body":"date = ann.date\nnew_anns = [] of Ann\nnot_added = true\n@anns.each do |a|\n  if not_added && a.date > date\n    new_anns << ann\n    not_add = false\n  end\n  new_anns << a\nend\nif not_added\n  new_anns << ann\nend\nold_anns = @anns\n@anns = new_anns\nerror, _, _ = make_books\nif error != \"\"\n  @anns = old_anns\nend\nerror\n"}},{"id":"anns:Array(MyMarket::Ann)-instance-method","html_id":"anns:Array(MyMarket::Ann)-instance-method","name":"anns","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Array(MyMarket::Ann)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/journal.cr#L22","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/journal.cr#L22","def":{"name":"anns","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@anns"}},{"id":"make_books:NamedTuple()-instance-method","html_id":"make_books:NamedTuple()-instance-method","name":"make_books","doc":"Process all the annotations and generates accounting books.\n\nIt returns:\n* error: String. If there is no error returns an empty string. Otherwise\n  returns the error.\n* ledger: Ledger. If there is error returns blank ledger (all values 0.0)\n* inventory: Inventory. If there is error returns an empty inventory.\n\nError codes are:\n* 0date (e.g. \"020181009\") if nick is not in inventory when selling.\n* 1date (e.g. \"120181009\") if trying to sell more stocks than there\n  are in inventory.","summary":"<p>Process all the annotations and generates accounting books.</p>","abstract":false,"args":[],"args_string":" : NamedTuple()","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/journal.cr#L113","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/journal.cr#L113","def":{"name":"make_books","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"NamedTuple(error: String, ledger: Ledger, inventory: Inventory)","visibility":"Public","body":"err = \"\"\nledger = Ledger.new\ninventory = Inventory.new\nanns.each do |ann|\n  case ann.type\n  when Ann::Type::Sell\n    ie = inventory[ann.nick]?\n    if !ie\n      err = \"0\" + ann.date\n      break\n    end\n    if ie.stocks < ann.stocks\n      err = \"1\" + ann.date\n      break\n    end\n    iout = ann.stocks * ie.price\n    inventory.remove(ann.nick, ann.stocks)\n    income0 = ann.stocks * ann.money\n    fees = Fees.app(income0)\n    income = income0 - fees\n    dif = income0 - iout\n    ledger.cash = ledger.cash + income\n    ledger.stocks = ledger.stocks - iout\n    ledger.sells = ledger.sells + dif\n    ledger.fees = ledger.fees - fees\n  when Ann::Type::Buy\n    pay0 = ann.stocks * ann.money\n    fees = Fees.app(pay0)\n    pay = pay0 + fees\n    inventory.add(ann.nick, ann.stocks, ann.money)\n    ledger.cash = ledger.cash - pay\n    ledger.stocks = ledger.stocks + pay0\n    ledger.fees = ledger.fees - fees\n  when Ann::Type::Withdrawal\n    ledger.cash = ledger.cash - ann.money\n    ledger.capital = ledger.capital - ann.money\n  when Ann::Type::Income\n    ledger.cash = ledger.cash + ann.money\n    ledger.capital = ledger.capital + ann.money\n  when Ann::Type::Profits\n    ledger.cash = ledger.cash + ann.money\n    ledger.incomes = ledger.incomes + ann.money\n  when Ann::Type::Fees\n    ledger.cash = ledger.cash - ann.money\n    ledger.fees = ledger.fees - ann.money\n  when Ann::Type::Pdif\n    ledger.cash = ledger.cash + ann.money\n    ledger.differences = ledger.differences + ann.money\n  when Ann::Type::Ndif\n    ledger.cash = ledger.cash - ann.money\n    ledger.differences = ledger.differences - ann.money\n  when Ann::Type::InitialCapital\n    ledger.capital = ledger.capital + ann.money\n  when Ann::Type::InitialCash\n    ledger.cash = ledger.cash + ann.money\n  when Ann::Type::InitialStock\n    ledger.stocks = ledger.stocks + (ann.stocks * ann.money)\n    inventory.add(ann.nick, ann.stocks, ann.money)\n  else\n    raise(ArgumentError.new(\"Unkown type annotation\"))\n  end\nend\nif err != \"\"\n  return mk_error(err)\nend\n{error: err, ledger: ledger, inventory: inventory}\n"}},{"id":"modify(ix:Int32,ann:Ann):String-instance-method","html_id":"modify(ix:Int32,ann:Ann):String-instance-method","name":"modify","doc":null,"summary":null,"abstract":false,"args":[{"name":"ix","doc":null,"default_value":"","external_name":"ix","restriction":"Int32"},{"name":"ann","doc":null,"default_value":"","external_name":"ann","restriction":"Ann"}],"args_string":"(ix : Int32, ann : Ann) : String","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/journal.cr#L80","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/journal.cr#L80","def":{"name":"modify","args":[{"name":"ix","doc":null,"default_value":"","external_name":"ix","restriction":"Int32"},{"name":"ann","doc":null,"default_value":"","external_name":"ann","restriction":"Ann"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"String","visibility":"Public","body":"new_anns = [] of Ann\n@anns.each_with_index do |a, i|\n  if i == ix\n    new_anns << ann\n  else\n    new_anns << a\n  end\nend\nold_anns = @anns\n@anns = new_anns\nerror, _, _ = make_books\nif error != \"\"\n  @anns = old_anns\nend\nerror\n"}},{"id":"remove(ix:Int32):String-instance-method","html_id":"remove(ix:Int32):String-instance-method","name":"remove","doc":"Remove an annotation.\n\nIf operation fails returns:\n* 0date (e.g. \"020181009\") if nick is not in inventory when selling.\n* 1date (e.g. \"120181009\") if trying to sell more stocks than there\n  are in inventory.","summary":"<p>Remove an annotation.</p>","abstract":false,"args":[{"name":"ix","doc":null,"default_value":"","external_name":"ix","restriction":"Int32"}],"args_string":"(ix : Int32) : String","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/journal.cr#L63","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/journal.cr#L63","def":{"name":"remove","args":[{"name":"ix","doc":null,"default_value":"","external_name":"ix","restriction":"Int32"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"String","visibility":"Public","body":"new_anns = [] of Ann\n@anns.each_with_index do |a, i|\n  if i != ix\n    new_anns << a\n  end\nend\nold_anns = @anns\n@anns = new_anns\nerror, _, _ = make_books\nif error != \"\"\n  @anns = old_anns\nend\nerror\n"}},{"id":"to_json(jsb:JSON::Builder)-instance-method","html_id":"to_json(jsb:JSON::Builder)-instance-method","name":"to_json","doc":null,"summary":null,"abstract":false,"args":[{"name":"jsb","doc":null,"default_value":"","external_name":"jsb","restriction":"JSON::Builder"}],"args_string":"(jsb : JSON::Builder)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/journal.cr#L191","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/journal.cr#L191","def":{"name":"to_json","args":[{"name":"jsb","doc":null,"default_value":"","external_name":"jsb","restriction":"JSON::Builder"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"jsb.array do\n  @anns.each do |a|\n    a.to_json(jsb)\n  end\nend"}},{"id":"to_s:String-instance-method","html_id":"to_s:String-instance-method","name":"to_s","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : String","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/journal.cr#L199","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/journal.cr#L199","def":{"name":"to_s","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"String","visibility":"Public","body":"JSON.build do |jsb|\n  to_json(jsb)\nend"}}],"macros":[],"types":[]},{"html_id":"github.com/dedeme/dmWeb/MyMarket/Ledger","path":"MyMarket/Ledger.html","kind":"class","full_name":"MyMarket::Ledger","name":"Ledger","abstract":false,"superclass":{"html_id":"github.com/dedeme/dmWeb/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"github.com/dedeme/dmWeb/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"github.com/dedeme/dmWeb/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"my_market/data/ledger.cr","line_number":7,"url":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ledger.cr"}],"repository_name":"github.com/dedeme/dmWeb","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/dedeme/dmWeb/MyMarket","kind":"module","full_name":"MyMarket","name":"MyMarket"},"doc":null,"summary":null,"class_methods":[],"constructors":[{"id":"new-class-method","html_id":"new-class-method","name":"new","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ledger.cr#L16","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ledger.cr#L16","def":{"name":"new","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"id":"capital:Float64-instance-method","html_id":"capital:Float64-instance-method","name":"capital","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Float64","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ledger.cr#L10","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ledger.cr#L10","def":{"name":"capital","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@capital"}},{"id":"capital=(capital)-instance-method","html_id":"capital=(capital)-instance-method","name":"capital=","doc":null,"summary":null,"abstract":false,"args":[{"name":"capital","doc":null,"default_value":"","external_name":"capital","restriction":""}],"args_string":"(capital)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ledger.cr#L10","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ledger.cr#L10","def":{"name":"capital=","args":[{"name":"capital","doc":null,"default_value":"","external_name":"capital","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@capital = capital"}},{"id":"cash:Float64-instance-method","html_id":"cash:Float64-instance-method","name":"cash","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Float64","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ledger.cr#L9","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ledger.cr#L9","def":{"name":"cash","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@cash"}},{"id":"cash=(cash)-instance-method","html_id":"cash=(cash)-instance-method","name":"cash=","doc":null,"summary":null,"abstract":false,"args":[{"name":"cash","doc":null,"default_value":"","external_name":"cash","restriction":""}],"args_string":"(cash)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ledger.cr#L9","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ledger.cr#L9","def":{"name":"cash=","args":[{"name":"cash","doc":null,"default_value":"","external_name":"cash","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@cash = cash"}},{"id":"differences:Float64-instance-method","html_id":"differences:Float64-instance-method","name":"differences","doc":"Dividends and similar","summary":"<p>Dividends and similar</p>","abstract":false,"args":[],"args_string":" : Float64","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ledger.cr#L14","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ledger.cr#L14","def":{"name":"differences","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@differences"}},{"id":"differences=(differences)-instance-method","html_id":"differences=(differences)-instance-method","name":"differences=","doc":"Dividends and similar","summary":"<p>Dividends and similar</p>","abstract":false,"args":[{"name":"differences","doc":null,"default_value":"","external_name":"differences","restriction":""}],"args_string":"(differences)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ledger.cr#L14","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ledger.cr#L14","def":{"name":"differences=","args":[{"name":"differences","doc":null,"default_value":"","external_name":"differences","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@differences = differences"}},{"id":"fees:Float64-instance-method","html_id":"fees:Float64-instance-method","name":"fees","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Float64","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ledger.cr#L12","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ledger.cr#L12","def":{"name":"fees","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@fees"}},{"id":"fees=(fees)-instance-method","html_id":"fees=(fees)-instance-method","name":"fees=","doc":null,"summary":null,"abstract":false,"args":[{"name":"fees","doc":null,"default_value":"","external_name":"fees","restriction":""}],"args_string":"(fees)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ledger.cr#L12","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ledger.cr#L12","def":{"name":"fees=","args":[{"name":"fees","doc":null,"default_value":"","external_name":"fees","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@fees = fees"}},{"id":"incomes:Float64-instance-method","html_id":"incomes:Float64-instance-method","name":"incomes","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Float64","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ledger.cr#L13","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ledger.cr#L13","def":{"name":"incomes","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@incomes"}},{"id":"incomes=(incomes)-instance-method","html_id":"incomes=(incomes)-instance-method","name":"incomes=","doc":null,"summary":null,"abstract":false,"args":[{"name":"incomes","doc":null,"default_value":"","external_name":"incomes","restriction":""}],"args_string":"(incomes)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ledger.cr#L13","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ledger.cr#L13","def":{"name":"incomes=","args":[{"name":"incomes","doc":null,"default_value":"","external_name":"incomes","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@incomes = incomes"}},{"id":"sells:Float64-instance-method","html_id":"sells:Float64-instance-method","name":"sells","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Float64","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ledger.cr#L11","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ledger.cr#L11","def":{"name":"sells","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@sells"}},{"id":"sells=(sells)-instance-method","html_id":"sells=(sells)-instance-method","name":"sells=","doc":null,"summary":null,"abstract":false,"args":[{"name":"sells","doc":null,"default_value":"","external_name":"sells","restriction":""}],"args_string":"(sells)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ledger.cr#L11","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ledger.cr#L11","def":{"name":"sells=","args":[{"name":"sells","doc":null,"default_value":"","external_name":"sells","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@sells = sells"}},{"id":"stocks:Float64-instance-method","html_id":"stocks:Float64-instance-method","name":"stocks","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Float64","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ledger.cr#L8","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ledger.cr#L8","def":{"name":"stocks","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@stocks"}},{"id":"stocks=(stocks)-instance-method","html_id":"stocks=(stocks)-instance-method","name":"stocks=","doc":null,"summary":null,"abstract":false,"args":[{"name":"stocks","doc":null,"default_value":"","external_name":"stocks","restriction":""}],"args_string":"(stocks)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ledger.cr#L8","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ledger.cr#L8","def":{"name":"stocks=","args":[{"name":"stocks","doc":null,"default_value":"","external_name":"stocks","restriction":""}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@stocks = stocks"}},{"id":"to_json(jsb:JSON::Builder)-instance-method","html_id":"to_json(jsb:JSON::Builder)-instance-method","name":"to_json","doc":null,"summary":null,"abstract":false,"args":[{"name":"jsb","doc":null,"default_value":"","external_name":"jsb","restriction":"JSON::Builder"}],"args_string":"(jsb : JSON::Builder)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ledger.cr#L19","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ledger.cr#L19","def":{"name":"to_json","args":[{"name":"jsb","doc":null,"default_value":"","external_name":"jsb","restriction":"JSON::Builder"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"jsb.array do\n  jsb.number(stocks)\n  jsb.number(cash)\n  jsb.number(capital)\n  jsb.number(sells)\n  jsb.number(fees)\n  jsb.number(incomes)\n  jsb.number(differences)\nend"}},{"id":"to_s:String-instance-method","html_id":"to_s:String-instance-method","name":"to_s","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : String","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ledger.cr#L31","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/ledger.cr#L31","def":{"name":"to_s","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"String","visibility":"Public","body":"JSON.build do |jsb|\n  to_json(jsb)\nend"}}],"macros":[],"types":[]},{"html_id":"github.com/dedeme/dmWeb/MyMarket/Main","path":"MyMarket/Main.html","kind":"module","full_name":"MyMarket::Main","name":"Main","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"my_market/pages/main.cr","line_number":5,"url":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/pages/main.cr"}],"repository_name":"github.com/dedeme/dmWeb","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[{"html_id":"github.com/dedeme/dmWeb/MyMarket/Main","kind":"module","full_name":"MyMarket::Main","name":"Main"}],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/dedeme/dmWeb/MyMarket","kind":"module","full_name":"MyMarket","name":"MyMarket"},"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[{"id":"process(rq:JSON::Any):Tuple(Bool,String)-instance-method","html_id":"process(rq:JSON::Any):Tuple(Bool,String)-instance-method","name":"process","doc":null,"summary":null,"abstract":false,"args":[{"name":"rq","doc":null,"default_value":"","external_name":"rq","restriction":"JSON::Any"}],"args_string":"(rq : JSON::Any) : Tuple(Bool, String)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/pages/main.cr#L8","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/pages/main.cr#L8","def":{"name":"process","args":[{"name":"rq","doc":null,"default_value":"","external_name":"rq","restriction":"JSON::Any"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Tuple(Bool, String)","visibility":"Public","body":"if r = rq[\"rq\"]\n  case r.as_s\n  when \"init\"\n    Cgi.ok do |jsb|\n      jsb.field(\"conf\") do\n        jsb.raw(Iout.read_conf_s)\n      end\n      jsb.field(\"closed\", true)\n    end\n  when \"logout\"\n    spawn do\n      Iout.automatic_backup\n      sleep(1)\n      exit(0)\n    end\n    Cgi.ok\n  else\n    Cgi.fail(\"Main-rq: value '#{r.as_s}' is unknown\")\n  end\nelse\n  Cgi.fail(\"Main: Field 'rq' is missing\")\nend"}}],"macros":[],"types":[]},{"html_id":"github.com/dedeme/dmWeb/MyMarket/Settings","path":"MyMarket/Settings.html","kind":"module","full_name":"MyMarket::Settings","name":"Settings","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"my_market/pages/core/settings.cr","line_number":5,"url":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/pages/core/settings.cr"}],"repository_name":"github.com/dedeme/dmWeb","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[{"html_id":"github.com/dedeme/dmWeb/MyMarket/Settings","kind":"module","full_name":"MyMarket::Settings","name":"Settings"}],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/dedeme/dmWeb/MyMarket","kind":"module","full_name":"MyMarket","name":"MyMarket"},"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[{"id":"process(rq:JSON::Any):Tuple(Bool,String)-instance-method","html_id":"process(rq:JSON::Any):Tuple(Bool,String)-instance-method","name":"process","doc":null,"summary":null,"abstract":false,"args":[{"name":"rq","doc":null,"default_value":"","external_name":"rq","restriction":"JSON::Any"}],"args_string":"(rq : JSON::Any) : Tuple(Bool, String)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/pages/core/settings.cr#L8","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/pages/core/settings.cr#L8","def":{"name":"process","args":[{"name":"rq","doc":null,"default_value":"","external_name":"rq","restriction":"JSON::Any"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Tuple(Bool, String)","visibility":"Public","body":"case rq[\"rq\"].as_s\nwhen \"init\"\n  user = Iout.read_conf.user\n  years = Years.new(user)\n  Cgi.ok do |jsb|\n    jsb.field(\"users\") do\n      jsb.array do\n        Users.list.each do |u|\n          jsb.string(u)\n        end\n      end\n    end\n    jsb.field(\"years\") do\n      jsb.array do\n        years.list.each do |y|\n          jsb.string(y)\n        end\n      end\n    end\n  end\nwhen \"setLang\"\n  Iout.set_lang(rq[\"lang\"].as_s)\n  Cgi.ok\nwhen \"addUser\"\n  Users.add(rq[\"user\"].as_s)\n  Cgi.ok\nwhen \"removeUser\"\n  Users.remove(rq[\"user\"].as_s)\n  Cgi.ok\nwhen \"modifyUser\"\n  Users.modify(rq[\"old_user\"].as_s, rq[\"user\"].as_s)\n  Cgi.ok\nwhen \"selectUser\"\n  Users.remove(rq[\"user\"].as_s)\n  Cgi.ok\nelse\n  Cgi.fail(\"Settings-rq: value '#{rq[\"rq\"].as_s}' is unknown\")\nend"}}],"macros":[],"types":[]},{"html_id":"github.com/dedeme/dmWeb/MyMarket/Users","path":"MyMarket/Users.html","kind":"module","full_name":"MyMarket::Users","name":"Users","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"my_market/data/users.cr","line_number":6,"url":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/users.cr"}],"repository_name":"github.com/dedeme/dmWeb","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[{"html_id":"github.com/dedeme/dmWeb/MyMarket/Users","kind":"module","full_name":"MyMarket::Users","name":"Users"}],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/dedeme/dmWeb/MyMarket","kind":"module","full_name":"MyMarket","name":"MyMarket"},"doc":"Users management","summary":"<p>Users management</p>","class_methods":[],"constructors":[],"instance_methods":[{"id":"add(user:String)-instance-method","html_id":"add(user:String)-instance-method","name":"add","doc":null,"summary":null,"abstract":false,"args":[{"name":"user","doc":null,"default_value":"","external_name":"user","restriction":"String"}],"args_string":"(user : String)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/users.cr#L14","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/users.cr#L14","def":{"name":"add","args":[{"name":"user","doc":null,"default_value":"","external_name":"user","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"if !list.any? do |u|\n  u == user\nend\n  Io.mkdir(\"#{Cts.annotations_dir}/#{user}\")\n  year = Time.new.year.to_s\n  Io.write(\"#{Cts.annotations_dir}/#{user}/#{year}\", \"[]\")\nend"}},{"id":"list:Array(String)-instance-method","html_id":"list:Array(String)-instance-method","name":"list","doc":"Returns an unsorted list","summary":"<p>Returns an unsorted list</p>","abstract":false,"args":[],"args_string":" : Array(String)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/users.cr#L10","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/users.cr#L10","def":{"name":"list","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Array(String)","visibility":"Public","body":"Io.children(Cts.annotations_dir)"}},{"id":"modify(old_user:String,new_user:String)-instance-method","html_id":"modify(old_user:String,new_user:String)-instance-method","name":"modify","doc":null,"summary":null,"abstract":false,"args":[{"name":"old_user","doc":null,"default_value":"","external_name":"old_user","restriction":"String"},{"name":"new_user","doc":null,"default_value":"","external_name":"new_user","restriction":"String"}],"args_string":"(old_user : String, new_user : String)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/users.cr#L33","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/users.cr#L33","def":{"name":"modify","args":[{"name":"old_user","doc":null,"default_value":"","external_name":"old_user","restriction":"String"},{"name":"new_user","doc":null,"default_value":"","external_name":"new_user","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"ls = list\nif ls.any? do |u|\n  u == old_user\nend\n  Io.rename(\"#{Cts.annotations_dir}/#{old_user}\", \"#{Cts.annotations_dir}/#{new_user}\")\nend\n"}},{"id":"remove(user:String)-instance-method","html_id":"remove(user:String)-instance-method","name":"remove","doc":null,"summary":null,"abstract":false,"args":[{"name":"user","doc":null,"default_value":"","external_name":"user","restriction":"String"}],"args_string":"(user : String)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/users.cr#L22","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/users.cr#L22","def":{"name":"remove","args":[{"name":"user","doc":null,"default_value":"","external_name":"user","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"ls = list\nif ls.any? do |u|\n  u == user\nend\n  if ls.size == 1\n    raise(ArgumentError.new(\"It is not posible to remove an only user\"))\n  else\n    Io.del(\"#{Cts.annotations_dir}/#{user}\")\n  end\nend\n"}}],"macros":[],"types":[]},{"html_id":"github.com/dedeme/dmWeb/MyMarket/Years","path":"MyMarket/Years.html","kind":"class","full_name":"MyMarket::Years","name":"Years","abstract":false,"superclass":{"html_id":"github.com/dedeme/dmWeb/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"github.com/dedeme/dmWeb/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"github.com/dedeme/dmWeb/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"my_market/data/years.cr","line_number":6,"url":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/years.cr"}],"repository_name":"github.com/dedeme/dmWeb","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/dedeme/dmWeb/MyMarket","kind":"module","full_name":"MyMarket","name":"MyMarket"},"doc":"Users management","summary":"<p>Users management</p>","class_methods":[],"constructors":[{"id":"new(user:String)-class-method","html_id":"new(user:String)-class-method","name":"new","doc":null,"summary":null,"abstract":false,"args":[{"name":"user","doc":null,"default_value":"","external_name":"user","restriction":"String"}],"args_string":"(user : String)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/years.cr#L9","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/years.cr#L9","def":{"name":"new","args":[{"name":"user","doc":null,"default_value":"","external_name":"user","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize(user)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"id":"addFirst-instance-method","html_id":"addFirst-instance-method","name":"addFirst","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/years.cr#L28","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/years.cr#L28","def":{"name":"addFirst","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"first_year = list[0]\nnew_year = (first_year.to_i - 1).to_s\nj = read_journal(first_year)\nanns = j.anns.take_while do |a|\n  a.date[4..-1] == \"0101\"\nend\nnew_j = journal_new\nanns.each do |a|\n  new_j.add(a)\nend\nwrite_jounal(new_year, new_j)\n"}},{"id":"addLast:String-instance-method","html_id":"addLast:String-instance-method","name":"addLast","doc":"'addLast' closes last year and create the next one.\n\nIf closing fails return an error with codes:\n* 0date (e.g. \"020181009\") if nick is not in inventory when selling.\n* 1date (e.g. \"120181009\") if trying to sell more stocks than there\n  are in inventory.","summary":"<p>'addLast' closes last year and create the next one.</p>","abstract":false,"args":[],"args_string":" : String","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/years.cr#L45","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/years.cr#L45","def":{"name":"addLast","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"String","visibility":"Public","body":"last_year = list[-1]\nnew_year = (first_year.to_i + 1).to_s\nj = read_journal(last_yar)\nerr, ledger, inventory = j.make_books\nif err != \"\"\n  return err\nend\nnew_j = j.close(ledger, inventory, Journal.new, new_year)\nwrite_jounal(new_year, new_j)\n"}},{"id":"list:Array(String)-instance-method","html_id":"list:Array(String)-instance-method","name":"list","doc":"Returns a sorted list from before to after","summary":"<p>Returns a sorted list from before to after</p>","abstract":false,"args":[],"args_string":" : Array(String)","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/years.cr#L24","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/years.cr#L24","def":{"name":"list","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Array(String)","visibility":"Public","body":"(Io.children(\"#{Cts.annotations_dir}/#{@user}\")).sort"}},{"id":"removeFirst-instance-method","html_id":"removeFirst-instance-method","name":"removeFirst","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/years.cr#L66","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/years.cr#L66","def":{"name":"removeFirst","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"if list.size > 1\n  year = list[0]\n  Io.del(\"#{Cts.annotations_dir}/#{@user}/#{year}\")\nend"}},{"id":"removeLast-instance-method","html_id":"removeLast-instance-method","name":"removeLast","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/years.cr#L59","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/years.cr#L59","def":{"name":"removeLast","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"if list.size > 1\n  year = list[-1]\n  Io.del(\"#{Cts.annotations_dir}/#{@user}/#{year}\")\nend"}},{"id":"user:String-instance-method","html_id":"user:String-instance-method","name":"user","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : String","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/years.cr#L7","source_link":"https://github.com/dedeme/dmWeb/blob/d461f13491d68453385c8bfeccb6b852294b169d/src/my_market/data/years.cr#L7","def":{"name":"user","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@user"}}],"macros":[],"types":[]}]}]}}