// Copyright 20-Apr-2020 ÂºDeme
// GNU General Public License - V3 <http://www.gnu.org/licenses/>

module quoteTest;

load es.dm.std;
load es.dm.assert;
load data.quote;

{
  run () =
    println "Quote test:";
    eq (toStr
          <$> fromStr "20190204:2.0500:2.0701:3.0000:2.0004:999234111:false")
       (Some "20190204:2.05:2.0701:3:2.0004:999234111:false");
    eq (toStr
          <$> fromStr "20190204:2.0500   :2.0701:3.0000:2.0004:999234111:false")
       (Some "20190204:2.05:2.0701:3:2.0004:999234111:false");
    eq (toStr
          <$> fromStr "20190204:2.0500:2.0701d:3.0000:2.0004:999234111:false")
       (Some "20190204:2.05:2.0701:3:2.0004:999234111:false");
    eq (toStr <$> fromStr "20190204:-1:-1:-1:-1:-1:true")
       (Some "20190204:-1:-1:-1:-1:-1:true");
    eq (fromStr "2019024:2.0500:2.0700:3.0000:2.0000:234111:false") (None ());
    eq (fromStr "2d019024:2.0500:2.0700:3.0000:2.0000:234111:false") (None ());
    eq (fromStr "20190204:2.0500:2.0700:3.0d000:d2.0000:234111:false")
       (None ());
    eq (fromStr "20190204:2.0500:2.0700:3.0000:2.0000:234d111:false") (None ());
    eq (fromStr "20190204:2.0500:2.0700:3.0000:2.0000:234111:f") (None ());

    println "    Finished.";
}